\documentclass[aip,jcp,a4paper,reprint,onecolumn]{revtex4-1}

\usepackage[fleqn]{amsmath}
\usepackage{amssymb}
\usepackage[dvips]{graphicx}
\usepackage{color}
\usepackage{tabularx}
\usepackage{algorithm}
\usepackage{algorithmic}

\makeatletter
\makeatother

\newcommand{\recheck}[1]{{\color{red} #1}}
\newcommand{\redc}[1]{{\color{red} #1}}
\newcommand{\bluec}[1]{{\color{blue} #1}}
\newcommand{\vect}[1]{\textbf{\textit{#1}}}
\newcommand{\dd}{\textsf{d}}
\newcommand{\inv}{\textrm{inv}}

\newcommand{\mh}{\mathcal H}
\newcommand{\eps}{\varepsilon}
\newcommand{\ml}{\mathcal L}
\newcommand{\me}{\mathcal E}
\newcommand{\mt}{\mathcal T}
\newcommand{\mo}{\mathcal O}
\newcommand{\mi}{\mathcal I}
\newcommand{\mc}{\mathcal C}
\newcommand{\proj}{\mathit\Pi}
\newcommand{\fwg}{{\mathcal A}}
\newcommand{\bwg}{{\mathcal B}}
\newcommand{\bsigma}{\boldsymbol\sigma}
\newcommand{\pathmeas}{\mathcal P}


\begin{document}


\title{Calculating the nonequilibrium observable by a speed-boosting
technique}
\author{Han Wang}
\affiliation{Institute for Mathematics, Freie Universit\"at Berlin, Germany}
\author{Christof Sch\"utte}
\affiliation{Institute for Mathematics, Freie Universit\"at Berlin, Germany}
\affiliation{Zuse Institute Berlin (ZIB), Germany}
% \affiliation{Institute for Mathematics, Freie Universit\"at Berlin, Germany}

\date{\today}

\begin{abstract}
\end{abstract}

\maketitle



\section{Theoretical background}

All formula will be developed formally. We consider the following SDE:
\begin{align}\label{eqn:sde-1}
  \dd \vect x_t = \vect b(\vect x_t, t)\, \dd t + \sigma\dd \vect w_t
\end{align}
And we are interested in some nonequilibrium observable of the system,
which is expressed by
\begin{align*}
  O(T) = \int \dd\vect x_0 \rho(\vect x_0, 0)
  \int_{\mc\{T; \vect x_0, 0\}} 
  O[\vect x_t]\,\dd\pathmeas[\vect x_t]
\end{align*}
where $\mc\{t; \vect x_0, 0\}$ denotes the set of all continuous
trajectories that initially starts at $\vect x_0$, and ends at time $T$.
$\rho(\vect x_0, 0)$ denotes the probability density of the initial position
$\vect x_0$. $\dd \pathmeas$ denotes the probability measure of the trajectories
generated by SDE~\eqref{eqn:sde-1}.

We want to understand if the nonequilibrium observable can be calculated
by an accelerating technique. 
More precisely, we want to design a new
SDE
\begin{align}\label{eqn:sde-2}
  \dd \vect y_t = \tilde{\vect b}(\vect y_t, t)\,\dd t + \tilde\sigma\dd \vect w_t,
\end{align}
such that the solution $\vect y_{t}$ satisfies
\begin{align}\label{eqn:tmp3}
  \vect y_t = \vect x_{\alpha t}, \quad t \in [0, T/\alpha)
\end{align}
We assumes the same initial condition for both the dynamics.
Here $\alpha$ is the scaling
prefactor. $\alpha > 1$ means Eq.~\eqref{eqn:sde-2} is an accelerated
dynamics w.r.t. Eq.~\eqref{eqn:sde-1}, while if $\alpha < 1$ means a
a slowdown.
The
observable of the original dynamics can be replace by the observation
of the accelerated dynamics via the following relation:
\begin{align}\nonumber
  \tilde O(T/\alpha) &=
  \int \dd\vect y_0 {\rho}(\vect y_0, 0)
  \int_{\mc\{T/\alpha; \vect y_0, 0\}} 
  O[\vect y_t]\,\dd\tilde\pathmeas[\vect y_t]\\\nonumber
  & =
  \int\dd\vect x_0\rho(\vect x_0, 0)
  \int_{\mc\{T/\alpha; \vect x_0, 0\}}
  O[\vect x_{\alpha t}] \dd\pathmeas[\vect x_{\alpha t}]\\\nonumber
  & = 
  \int\dd\vect x_0\rho(\vect x_0, 0)
  \int_{\mc\{T; \vect x_0, 0\}}
  O[\vect x_{ t}] \dd\pathmeas[\vect x_{ t}]\\
  & = O(t)
\end{align}
That means for rescale dynamics~\eqref{eqn:sde-2} we only need to simulate
it until time $T/\alpha$, and the calculated observable that
is the same as the original dynamics. Now the problem is how to design
the rescaled dynamics. Actually, the solution is very simple, we simply
let
\begin{align}
  \tilde {\vect b}(\vect y, t) = \alpha\, {\vect b}(\vect y, \alpha t)\quad
  \textrm{and}\quad
  \tilde\sigma = \sqrt{\alpha}\,\sigma
\end{align}
Then the Eq.~\eqref{eqn:tmp3} is automatically satisfied.
% Moreover, by the fluctuation-dissipation theorem,
% the temperature of the system remains the same, which implies
% a preserved invariant measure in the equilibrium case.
However, stability or the largest allowed time-step of the numerical
solution of the dynamics depends on the fastest modes of the
force $\vect b$. When the force $\vect b$ is rescaled by $\alpha$, the
largest time-step is also rescaled by $1/\alpha$, so the total computational
cost of is not reduced by this rescaling technique.

Now we want to eliminate the fast modes in~\eqref{eqn:sde-2}, so that
the largest time-step is not smaller than the original
dynamics~\eqref{eqn:sde-1}, and at the same time the numerical
accuracy for calculating the observable should be preserved. Please notice
that the numerical accuracy of the trajectories are not necessarily
preserved.
Therefore, we need some estimate on the trajectory, which will
be developed under the framework of  Girsanov  transformation.
Now assume that the original forcing can be split by
\begin{align}
  \vect b(\vect x) = \vect b_s (\vect x) + \vect b_f(\vect x)
\end{align}
where $\vect b_f(\vect x)$ is the fast part of the force, while $\vect b_s
(\vect x)$ is the slow part.
We revise the force of the  accelerated dynamics~\eqref{eqn:sde-2} by
\begin{align}
  \hat{\vect b} = \alpha \vect b_s + \vect b_f,
\end{align}
and keeps the diffusion coefficient $\tilde\sigma$ unchanged.
Therefore, the difference between the observable calculated by the
accelerated dynamics and the original observable is given by 
\begin{align}\nonumber
  O(T) &= \tilde O(T/\alpha)\\\nonumber  
  &=\int \dd\vect y_0 {\rho}(\vect y_0, 0)
  \int_{\mc\{T/\alpha; \vect y_0, 0\}} 
  O[\vect y_t]\,\dd\tilde\pathmeas[\vect y_t]\\\nonumber
  &=
  \int \dd\vect y_0 {\rho}(\vect y_0, 0)
  \int_{\mc\{T/\alpha; \vect y_0, 0\}}
  O[\vect y_t] \frac{\dd\tilde\pathmeas[\vect y_t]}{\dd\hat\pathmeas[\vect y_t]}
  \dd\hat\pathmeas[\vect y_t]
\end{align}
Since we have $\tilde{\vect b} - \hat{\vect b} = (\alpha - 1)\vect b_f$,
by the Girsanov transformation, we have
\begin{align}\label{eqn:meas-reweight}
  \frac{\dd\tilde\pathmeas[\vect y_t]}{\dd\hat\pathmeas[\vect y_t]}
  = \exp
  \Big[
  \frac{\alpha-1}{\tilde{\sigma}}\int_0^{T/\alpha}\vect b_f(\vect y_s)\cdot\dd\vect w_s
  -
  \frac{(\alpha-1)^2}{2\tilde\sigma^2} \int_0^{T/\alpha}\vect b_f^2(\vect y_s)\dd t\,
  \Big]
\end{align}
We therefore have the error estimate
\begin{align}\label{eqn:o-error}
  O(T) = \hat O(T/\alpha)  +
  \int \dd\vect y_0 {\rho}(\vect y_0, 0)\cdot \me(\vect y_0, T/\alpha)
\end{align}
where
\begin{align}
  \me(\vect y_0, t) = 
  \int_{\mc\{T/\alpha; \vect y_0, 0\}}
  O[\vect y_t]
  \cdot
  W[\vect y_t]\,\dd\hat\pathmeas
\end{align}
and $W[\vect y_s]$ is defined by
\begin{align}
  W[\vect y_t] = 
  \exp
  \Big[
  \frac{\alpha-1}{\tilde{\sigma}}\int_0^{T/\alpha}\vect b_f(\vect y_s)\cdot\dd\vect w_s
  -
  \frac{(\alpha-1)^2}{2\tilde\sigma^2} \int_0^{T/\alpha}\vect b_f^2(\vect y_s)\dd t\,
  \Big]
  -1
\end{align}
Now the problem is that when the accelerate
approximation~\eqref{eqn:o-error} has a good accuracy. One possibility
is that the measure reweighting~\eqref{eqn:meas-reweight} is small.
However, as a matter of fact, the reweighting is usually not small,
because the fast part of the force is usually large. The other possibility
is that the observable $O[\vect y]$ has vanished correlation with
$W[\vect y]$.
This is usually true if in the system the fast DOFs are decoupled with
the slow variables, and the observation is only on the space spanned
by the slow variables.


Being more specifically, in a molecular system, it is reasonable to
assume that the vibrational DOFs are decoupled with the slow variable.
Therefore, as a good approximation, people use rigid bonds instead of
flexible bonds to increase time-step of the simulation. Please notice
if the numerical scheme only has first order accuracy, than our accelerating
technique is equivalent to increasing the time-step of the simulation.
If higher order numerical schemes are used, our accelerating technique
is more accurate than simply using larger time-steps.

The other fast variable is the repulsive part of the Lennard-Jones
interaction, which can be removed by the following way: we define a
smooth switching function $s(r)$ that has value 0 at repulsive part of
the LBJ potential, while has value of 1 at the attractive part. Then
the accelerated LJ potential (denoted by $\hat u(r)$) can be given by
\begin{align}
  \hat u(r) = \alpha s(r) u(r) + (1 - s(r)) u(r)
\end{align}
where $u(r)$ is the original LJ potential. It is clear that
 $\hat u(0) = u(0)$, and $\hat u(\infty) = \alpha u(\infty)$.












\end{document}
