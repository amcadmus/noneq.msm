% \documentclass[aip,jcp,preprint,unsortedaddress,a4paper,onecolum]{revtex4-1}
\documentclass[aip,jcp,a4paper,reprint,onecolumn]{revtex4-1}
% \documentclass[aps,pre,twocolumn]{revtex4-1}
% \documentclass[aps,jcp,groupedaddress,twocolumn,unsortedaddress]{revtex4}

\usepackage[fleqn]{amsmath}
\usepackage{amssymb}
\usepackage[dvips]{graphicx}
\usepackage{color}
\usepackage{tabularx}
\usepackage{algorithm}
\usepackage{algorithmic}

\makeatletter
\makeatother

\newcommand{\recheck}[1]{{\color{red} #1}}
\newcommand{\redc}[1]{{\color{red} #1}}
\newcommand{\bluec}[1]{{\color{blue} #1}}
\newcommand{\vect}[1]{\textbf{\textit{#1}}}
\newcommand{\dd}{\textsf{d}}

\newcommand{\mh}{\mathcal H}
\newcommand{\ml}{\mathcal L}
\newcommand{\mt}{\mathcal T}
\newcommand{\EX}{{\textrm{EX}}}
\newcommand{\CG}{{\textrm{CG}}}
\newcommand{\HY}{{\Delta}}



\begin{document}

\title{Linear response theory for core set identification}
\author{Han Wang}
% \affiliation{Institute for Mathematics, Freie Universit\"at Berlin, Germany}
\author{Christof Sch\"utte}
\affiliation{Institute for Mathematics, Freie Universit\"at Berlin, Germany}
% \affiliation{Institute for Mathematics, Freie Universit\"at Berlin, Germany}

\date{\today}

\begin{abstract}
  % In this draft, we are trying to study the core set based Markov
  % State Model (MSM) under non-equilirbium conditions.
\end{abstract}

\maketitle

\section{Theoretical considerations}
\subsection{The linear response theory}
In this sub-section, we give a brief description of the linear response
theory, for details see Ref.~\cite{tuckeman2010statistical} for
example. Here we assume the system is governed by equation:
\begin{align}\label{eqn:gov-1}
  \dot{\vect q}_i & = \frac{\partial\mh}{\partial \vect p_i}
  + \vect C_i(\vect q,\vect p) F_e(t)\\\label{eqn:gov-2}
  \dot{\vect p}_i & =- \frac{\partial\mh}{\partial \vect q_i}
  + \vect D_i(\vect q,\vect p) F_e(t)
\end{align}
Where $\vect C$ and $\vect D$ are perturbations to the system, and
$F_e(t)$ is the strength of the perturbation as a function of time.
The phase space imcompressibility condition is assumed:
\begin{align}
  \sum_{i=1}^{3N}
  \bigg[
  \frac{\partial \vect C_i}{\partial \vect q_i} +
  \frac{\partial \vect D_i}{\partial \vect p_i}
  \bigg] = 0
\end{align}
Then the phase space distribution $f(\vect x, t)$ ($\vect x = \{\vect
q_i, \vect p_i\}$) is subject to the Liouville equation:
\begin{align}
  \frac{\partial}{\partial t} f(\vect x, t) + i\ml f(\vect x, t) = 0
\end{align}
where $\ml$ is the Liouville operator given by $i\ml = \dot{\vect
  x}\cdot\nabla_{\vect x}$.  We assume that the perturbation to the
system is so small that both the phase space distribution and the
Liouville operator can be viewed as perturbation from the equilibrium
distribution (invariant measure) and the unperturbed operator,
respectively. Namely
\begin{align}
  f(\vect x, t) &= f_0(\vect x) + \Delta  f(\vect x, t)
\end{align}
and since the Eqn.~\eqref{eqn:gov-1} and \eqref{eqn:gov-2} imply that
$\dot{\vect x} = \dot{\vect x}_0 + \Delta \dot{\vect x}(t)$
\begin{align}
  i\ml =
  (\dot{\vect x}_0 + \Delta \dot{\vect x}(t))\cdot\nabla_{\vect x}
  = i\ml_0 + i\Delta\ml(t)
\end{align}
Where the invariant measure satisfies $i\ml_0f_0(\vect x) = 0$. Also
$f_0(\vect x)$ has the form $f_0(\mh(\vect x))$ (?). The Liouville equation
for the perturbed system is therefore:
\begin{align}
  \frac{\partial}{\partial t}
  [f_0(\mh(\vect x)) + \Delta  f(\vect x, t)]
  +
  [i\ml_0 + i\Delta\ml(t)]
  [f_0(\mh(\vect x)) + \Delta  f(\vect x, t)] = 0
\end{align}
The basic assumption for the ``linear response'' is that the high order
term $i\Delta\ml(t)  \Delta  f(\vect x, t)$ in the Liouville equation
can be neglected. Noticing $i\ml_0 f_0 = 0$, we have the Liouville equation
for the leading order of perturbation:
\begin{align}
  \bigg[
  \frac{\partial}{\partial t}
  + i\ml_0
  \bigg]
  \Delta  f(\vect x, t)
  =
  - i\Delta\ml(t) f_0(\mh(\vect x))
\end{align}
The operator on l.h.s. is the same as the unperturbed Liouville equation.
Formally solving this equation with initial condition
$\Delta f(\vect x, 0) = 0$ gives
\begin{align}
  \Delta  f(\vect x, t) =
  - \int_0^t \dd s \:
  e^{-i\ml_0(t-s)}
  i\Delta\ml(s)f_0(\mh(\vect x))
\end{align}
By defining the \emph{dissipative flux},
\begin{align}
  j(\vect x) =
  -\sum_{i=1}^{3N}
  \bigg[
  \vect D_i(\vect x) \frac{\partial\mh}{\partial \vect p_i} +
  \vect C_i(\vect x) \frac{\partial\mh}{\partial \vect q_i}   
  \bigg]
\end{align}
it has been shown that~\cite{tuckeman2010statistical}
\begin{align}
  i\Delta\ml(s)f_0(\mh(\vect x)) =
  -\frac{\partial f_0(\mh)}{\partial\mh} j(\vect x)\,F_e(s)
\end{align}
For the canonical invariant measure, this is equivalent to
\begin{align}
  i\Delta\ml(s)f_0(\mh(\vect x)) =
  \beta f_0(\mh(\vect x)) j(\vect x)F_e(s)
\end{align}
For any observation:
\begin{align}\nonumber
  \mathcal A(t)
  &=
  \int\dd \vect x A(\vect x)f(\vect x, t)  \\\nonumber
  &=
  \int\dd \vect x\, A(\vect x)\,
  [f_0(\mh(\vect x)) + \Delta f(\vect x, t)] \\\nonumber
  &=
  \langle A\rangle_0
  -
  \beta
  \int \dd \vect x
  A(\vect x)
  \int_0^t\dd s\,
  e^{-i\ml_0(t-s)}
  f_0(\mh(\vect x)) j(\vect x)F_e(s)  \\\nonumber
  &=
  \langle A\rangle_0
  -
  \beta
  \int_0^t\dd s\,
  F_e(s)
  \int \dd \vect x\,
  A(\vect x)
  e^{-i\ml_0(t-s)}
  f_0(\mh(\vect x)) j(\vect x)  \\
  &=
  \langle A\rangle_0
  -
  \beta
  \int_0^t\dd s\,
  F_e(s)
  \int \dd \vect x\,
  f_0(\mh(\vect x))
  A(\vect x)
  e^{-i\ml_0(t-s)}
  j(\vect x)  
\end{align}
Notice that $e^{i\ml_0(t-s)}A(\vect x) = A(\phi_{t-s}(\vect x))$,
where $\phi_t(\vect x)$ is the flow mapping of the \emph{unperturbed}
Hamiltonian system. We have
\begin{align}
  \mathcal A(t)
  =
  \langle A\rangle_0
  -
  \beta
  \int_0^t\dd s\,
  F_e(s)
  \int \dd \vect x\,
  f_0(\mh(\vect x))
  A(\phi_{t-s}(\vect x))
  j(\vect x)  
\end{align}
or equivalently:
\begin{align}\label{eqn:lr}
  \mathcal A(t)
  =
  \langle A\rangle_0
  -
  \beta
  \int_0^t\dd s\,
  F_e(s)
  \langle
  A(t-s)\,
  j(0)\,
  \rangle_0
\end{align}
where $\langle A(t-s)\,j(0)\,\rangle_0$ is the \emph{equilibrium time
  correlation} between the observation $A$ at time $t-s$ and the
dissipative flux $j$ at time 0.


\subsection{The core set as an observation of the system}

The core set plays a very important role in the MSM theory. One way to
identify core set is to consider the ``stability'' of the invariant
measure $f_0$ under some mapping $\mt_\alpha$ of time step $\alpha$:
\begin{align}
  C_\alpha = \big\{
  \vect x \,\vert\, \mt_\alpha f_0(\vect x) > f_0(\vect x)
  \big\}
\end{align}
Generally, it is impossible and not necessary to consider the core set
in the $3N$ dimensional configuration space. For example, a
macromolecule solving in water, the DOFs of water is not of interest
at all. Therefore, we consider some phase space compressing function
$\vect y = \vect y(\vect x)$, with $\vect y \in \Omega \subset \mathbb
R^M,\ M\ll 3N$. We call $\Omega$ the observation space.  The projected
invariant measure on the observation space is therefore
\begin{align}
  \mathcal P f_0 (\vect y)
  =
  \int
  \dd \vect x\,
  f_0(\vect x) \,
  \delta (\vect y - \vect y(\vect x)) 
\end{align}
The core set on the observation space is
\begin{align}
  \widetilde
  C_\alpha = \big\{
  \vect y \,\vert\,
  \mathcal P\mt_\alpha f_0(\vect y) > \mathcal P f_0(\vect y)
  \big\}
\end{align}
% with $\widetilde \mt_\alpha$ defined by
% $\widetilde\mt_\alpha = \mathcal P\circ\mt_\alpha$, namely
% \begin{align}
%   \widetilde\mt_\alpha\, p_0(\vect y)
%   =
%   \mathcal P\circ\mt_\alpha f_0 (\vect y)
%   =
%   \int
%   \dd \vect x\,
%   [\mt_\alpha f_0](\vect x) \,
%   \delta (\vect y - \vect y(\vect x)) 
% \end{align}
For convenience, we define $\Delta \mt_\alpha =
\mt_\alpha - \mathcal I$, where $\mathcal I$ is the
identity. If $[\mathcal P\circ\Delta \mt_\alpha f_0](\vect y) > 0$, then
$\vect y$ is in the core set $\widetilde C_\alpha $.
\begin{align}\nonumber
  [\mathcal P\circ\Delta \mt_\alpha f_0](\vect y)
  &=
  \int
  \dd \vect x\,
  \Delta \mt_\alpha f_0(\vect x) \,
  \delta (\vect y - \vect y(\vect x))  \\\nonumber
  &=
  \lim_{\sigma \rightarrow 0}
  \int
  \dd \vect x\,
  \Delta \mt_\alpha f_0(\vect x) \,
  K_{\sigma} (\vect y - \vect y(\vect x))  \\\nonumber
  &=
  \lim_{\sigma \rightarrow 0}
  \int
  \dd \vect x\,
  \Delta \mt_\alpha f_0(\vect x) \,
  K_{\sigma, \vect y} (\vect x)  \\\nonumber
  &=
  \lim_{\sigma \rightarrow 0}
  \int
  \dd \vect x\,
  f_0(\vect x) \,
  [\Delta \mt_\alpha]^\dagger K_{\sigma, \vect y} (\vect x)\\
  &=
  \lim_{\sigma \rightarrow 0}\,
  \langle
  [\Delta \mt_\alpha]^\dagger K_{\sigma, \vect y}
  \rangle_0
\end{align}
where $[\Delta \mt_\alpha]^\dagger$ is the adjoint operator of $\Delta
\mt_\alpha$, which is actually $\Delta \mt_{-\alpha}$. The delta
function is replaced by the limit of a mollifier $K_\sigma(\vect y)$,
which is infinitely smooth, compact supported of size $\sigma$,
bounded and $\int
K_\sigma(\vect y)\dd \vect y = 1$.  The physical meaning is that we
can consider the expectation value of the stability of the mollifier
$K_{\sigma, \vect y}$ instead of the stability of the invariant measure.
This provides the convenience of using the linear response theory showed
in the previous section. By Eqn.~\eqref{eqn:lr},
\begin{align}\nonumber
  [\mathcal P\circ\Delta \mt_\alpha f_t](\vect y)
  &=
  \lim_{\sigma \rightarrow 0}\,
  \langle
  [\Delta \mt_\alpha]^\dagger K_{\sigma, \vect y}
  \rangle_t \\
  &=
  \lim_{\sigma \rightarrow 0}\,
  \Big\{
  \langle
  [\Delta \mt_\alpha]^\dagger K_{\sigma, \vect y}
  \rangle_0  -
  \beta
  \int_0^t\dd s\,
  F_e(s)
  \langle
  [\Delta \mt_\alpha]^\dagger K_{\sigma, \vect y}(t-s)\,
  j(0)\,
  \rangle_0
  \Big\}
\end{align}
Therefore, the core set at time $t$ is defined by
\begin{align}
  \widetilde C_\alpha^t =
  \Big\{
  \vect y
  \,\Big\vert\,
  [\mathcal P\circ\Delta \mt_\alpha f_t](\vect y) > 0
  \Big\}
\end{align}


\section*{References}
\bibliography{ref}{}
\bibliographystyle{unsrt}





\end{document}